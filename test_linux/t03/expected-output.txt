
netmon 1.0 start
Reading configuration from 'netmon.ini'
Configuration file 'netmon.ini', line 3: variable name not allowed in this section
Configuration file 'netmon.ini', line 4: syntax error
Configuration file 'netmon.ini', line 5: variable name not allowed in this section
Configuration file 'netmon.ini', line 6: variable program_command not allowed in this section
Configuration file 'netmon.ini', line 7: syntax error
Configuration file 'netmon.ini', line 8: variable log_file not allowed in this section
Configuration file 'netmon.ini', line 9: variable log_file not allowed in this section
Configuration file 'netmon.ini', line 10: variable log_file not allowed in this section
Configuration file 'netmon.ini', line 11: syntax error
Configuration file 'netmon.ini', line 18: variable method not allowed in this section
Configuration file 'netmon.ini', line 19: syntax error
Configuration file 'netmon.ini', line 20: variable method not allowed in this section
Configuration file 'netmon.ini', line 21: variable method not allowed in this section
Configuration file 'netmon.ini', line 30: empty value not allowed
Configuration file 'netmon.ini', line 32: variable method already defined
Configuration file 'netmon.ini', line 61: empty value not allowed
Configuration file 'netmon.ini', section of line 58: no command defined, discarding alert
Configuration file 'netmon.ini', section of line 62: no command defined, discarding alert
Configuration file 'netmon.ini', line 68: unknown variable command
Configuration file 'netmon.ini', section of line 65: no command defined, discarding alert
Configuration file 'netmon.ini', line 69: unknown section name 'xalert'
Configuration file 'netmon.ini', line 70: unknown section name 'alert1'
Configuration file 'netmon.ini', line 71: variable name not allowed in this section
Configuration file 'netmon.ini', line 72: variable method not allowed in this section
Configuration file 'netmon.ini', line 73: variable method not allowed in this section
Configuration file 'netmon.ini', line 74: variable method not allowed in this section
Configuration file 'netmon.ini', line 82: unknown value 'bla' for variable method
Configuration file 'netmon.ini', section of line 81: no name defined, discarding alert
Configuration file 'netmon.ini', section of line 81: unknown method, discarding alert
Configuration file 'netmon.ini', section of line 83: no method defined, discarding alert
Configuration file 'netmon.ini', line 93: empty value not allowed
Configuration file 'netmon.ini', section of line 90: no log file defined, discarding alert
Configuration file 'netmon.ini', section of line 94: no log file defined, discarding alert
keep_last_status not defined, taking default = 15
Check 'Local FTP': unknown alert 'email'
Check 'Local FTP': unknown alert ''
Check 'Local FTP': unknown alert ''
Check 'Local FTP': unknown alert ''
Check 'Local FTP': unknown alert ''
Check 'Local FTP': unknown alert 'sms2'
Check 'Test avec nom inconnu': unknown alert 'youpi'
== CHECK #0
   is_valid       = Yes
   display_name   = Local FTP
   host_name      = Localhost
   port           = 21
   expect         = 221 
   alerts         = main,	email 	,,  ,  ,  , critical , sms,sms2
   nb alerts      = 3
     alert:     = #0 -> main
     alert:     = #1 -> critical
     alert:     = #2 -> sms
   alert_threshold    = 3
   alert_repeat_every = <unset>
   alert_repeat_max   = <unset>
== CHECK #1
   is_valid       = Yes
   display_name   = Local HTTP
   host_name      = 127.0.0.1
   port           = 80
   expect         = <unset>
   alerts         = <unset>
   nb alerts      = 0
   alert_threshold    = <unset>
   alert_repeat_every = <unset>
   alert_repeat_max   = <unset>
== CHECK #2
   is_valid       = Yes
   display_name   = Local SMTP
   host_name      = My SMTP
   port           = 25
   expect         = 220 
   alerts         = <unset>
   nb alerts      = 0
   alert_threshold    = <unset>
   alert_repeat_every = <unset>
   alert_repeat_max   = <unset>
== CHECK #3
   is_valid       = Yes
   display_name   = My POP3
   host_name      = maison-pclin
   port           = 110
   expect         = +OK 
   alerts         = <unset>
   nb alerts      = 0
   alert_threshold    = <unset>
   alert_repeat_every = <unset>
   alert_repeat_max   = <unset>
== CHECK #4
   is_valid       = Yes
   display_name   = Test avec nom inconnu
   host_name      = a.b.c
   port           = 25
   expect         = <unset>
   alerts         = youpi
   nb alerts      = 0
   alert_threshold    = <unset>
   alert_repeat_every = <unset>
   alert_repeat_max   = <unset>
== ALERT #0
   is_valid          = Yes
   name              = main
   method            = smtp
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   SMTP/smart host = smtp1234.sfr.fr,smtp.sfr.fr
   SMTP/port       = <unset>
   SMTP/self       = localhostname
   SMTP/sender     = root@localhost
   SMTP/recipients = sebastien.millet1@club-internet.fr,root@localhost
== ALERT #1
   is_valid          = Yes
   name              = critical
   method            = smtp
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   SMTP/smart host = localhost
   SMTP/port       = <unset>
   SMTP/self       = <unset>
   SMTP/sender     = <unset>
   SMTP/recipients = root
== ALERT #2
   is_valid          = Yes
   name              = prgtest1
   method            = program
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   program/command   = allo
!! alert #3 (will be ignored)
   is_valid          = No
   name              = prgtest2
   method            = program
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   program/command   = <unset>
!! alert #4 (will be ignored)
   is_valid          = No
   name              = prgtest3
   method            = program
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   program/command   = <unset>
!! alert #5 (will be ignored)
   is_valid          = No
   name              = prgtest4
   method            = program
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   program/command   = <unset>
!! alert #6 (will be ignored)
   is_valid          = No
   name              = <unset>
   method            = <unset>
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
!! alert #7 (will be ignored)
   is_valid          = No
   name              = fake
   method            = <unset>
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
== ALERT #8
   is_valid          = Yes
   name              = log1
   method            = log
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   log/log_file      = yeslog
!! alert #9 (will be ignored)
   is_valid          = No
   name              = log2
   method            = log
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   log/log_file      = <unset>
!! alert #10 (will be ignored)
   is_valid          = No
   name              = log3
   method            = log
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   log/log_file      = <unset>
== ALERT #11
   is_valid          = Yes
   name              = log4
   method            = log
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   log/log_file      = eslog
== ALERT #12
   is_valid          = Yes
   name              = sms
   method            = smtp
   threshold         = <unset>
   repeat_every      = <unset>
   repeat_max        = <unset>
   retries           = <unset>
   SMTP/smart host = localhost
   SMTP/port       = 25
   SMTP/self       = <unset>
   SMTP/sender     = 
   SMTP/recipients = root@localhost
check_interval = 0
keep_last_status = 15
display_name_width = 20
html_directory = ../www
html_file = netmon.html
html_title = netmon 1.0
html_refresh_interval = 20
Valid check(s) defined: 5
Run web server: no
To check: 'Local FTP' [Localhost:21], expect "221 ", alerts: main, critical, sms
To check: 'Local HTTP' [127.0.0.1:80], no expect, no alert
To check: 'Local SMTP' [My SMTP:25], expect "220 ", no alert
To check: 'My POP3' [maison-pclin:110], expect "+OK ", no alert
To check: 'Test avec nom inconnu' [a.b.c:25], no expect, alerts: 
Will create image files in html directory
Starting check...
Performing check tcp(Local FTP)
TCP check(Local FTP): connecting to Localhost:21...
Running gethosbyname() on Localhost
Will connect to Localhost:21, timeout = 5
Connected to Localhost:21
<<< 220 (vsFTPd 2.3.5)
Unexpected answer: '220 (vsFTPd 2.3.5)' (expected '221 ')
TCP check(Local FTP): disconnected from Localhost:21
Local FTP -> ** KO **
as = 1, chk->trigger_sequence = 0
chk->nb_consecutive_notok = 1
trigger_alert = 0
Performing check tcp(Local HTTP)
TCP check(Local HTTP): connecting to 127.0.0.1:80...
Running gethosbyname() on 127.0.0.1
Will connect to 127.0.0.1:80, timeout = 5
Connected to 127.0.0.1:80
TCP check(Local HTTP): disconnected from 127.0.0.1:80
Local HTTP -> ok
as = 0, chk->trigger_sequence = 0
chk->nb_consecutive_notok = 0
trigger_alert = 0
Performing check tcp(Local SMTP)
TCP check(Local SMTP): connecting to My SMTP:25...
Running gethosbyname() on My SMTP
Unknown host My SMTP, code=110 (Connection timed out)
TCP check(Local SMTP): disconnected from My SMTP:25
Local SMTP -> ** ?? **
as = 1, chk->trigger_sequence = 0
chk->nb_consecutive_notok = 1
trigger_alert = 0
Performing check tcp(My POP3)
TCP check(My POP3): connecting to maison-pclin:110...
Running gethosbyname() on maison-pclin
Will connect to maison-pclin:110, timeout = 5
Socket error connecting to maison-pclin:110, code=113 (No route to host)
TCP check(My POP3): disconnected from maison-pclin:110
My POP3 -> ** KO **
as = 1, chk->trigger_sequence = 0
chk->nb_consecutive_notok = 1
trigger_alert = 0
Performing check tcp(Test avec nom inconnu)
TCP check(Test avec nom inconnu): connecting to a.b.c:25...
Running gethosbyname() on a.b.c
Unknown host a.b.c, code=110 (Connection timed out)
TCP check(Test avec nom inconnu): disconnected from a.b.c:25
Test avec nom inconnu -> ** ?? **
as = 1, chk->trigger_sequence = 0
chk->nb_consecutive_notok = 1
trigger_alert = 0
Check done in 0.123450s
netmon end
